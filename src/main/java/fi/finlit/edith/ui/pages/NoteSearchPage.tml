<html t:type="layout" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd" xmlns:p="tapestry:parameter">

    <p:title>${message:notesearch}</p:title>

    <t:form t:id="search">
        <t:errors />
        <t:textfield value="searchTerm" />
        <input type="submit" value="${message:search}" />
        <t:if test="notes">
            <div id="editcontrols">
                <t:if test="!editMode">
                    <t:actionlink t:id="toggleEdit">${message:edit}</t:actionlink>
                    <p:else>
                        <t:actionlink t:id="cancel">${message:cancel}</t:actionlink>
                    </p:else>
                </t:if>
            </div>
            <div class="cleaner"> </div>
         </t:if>
    </t:form>

    <t:if test="notes">
        <t:form t:id="edit">
            <div id="formcontrols">
                <t:if test="editMode">
                    <input type="submit" value="${message:save}" />
                </t:if>
            </div>
            <div class="cleaner"> </div>
            <t:grid source="notes" row="note" rowsPerPage="20" t:encoder="encoder"
                include="lemma,longText,description,subtextSources" add="documentRevision,basicForm,meaning,status,actions">
                <p:lemmaCell>
                    <t:if test="editMode">
                        <t:inlineField t:id="lemma" value="note.lemma" value1="note.lemma"/>
                        <p:else>
                            <em>${note.lemma}</em>
                        </p:else>
                    </t:if>
                </p:lemmaCell>
                <p:documentRevisionCell>
                    ${note.documentRevision?.document.title}
                </p:documentRevisionCell>
                <p:basicFormCell>
                    ${note.revisionOf.term?.basicForm}
                </p:basicFormCell>
                <p:longTextCell>
                    ${note.longText}
                </p:longTextCell>
                <p:descriptionCell>
                    <t:if test="editMode">
                        <t:inlineField t:id="description" value="note.description" value1="note.description" />
                        <p:else>
                            <t:markdown value="note.description"/>
                        </p:else>
                    </t:if>
                </p:descriptionCell>                
                <p:meaningCell>
                        ${note.revisionOf.term?.meaning}
                </p:meaningCell>
                <p:subtextSourcesCell>
                        <t:markdown value="note.subtextSources"/>
                </p:subtextSourcesCell>
                <p:statusCell>
					<t:fmt.message key="NoteStatus.${note.revisionOf.status}"/>
                </p:statusCell>
                <p:actionsCell>
                	<span class="delete_note">
                		<a href="" class="delete_question">${message:delete}</a>
                		<span class="delete_dialog">
                    		${message:delete}? <t:actionlink t:id="delete" context="note.id">${message:yes}</t:actionlink>
                    		/ <a href="" class="delete_note_decline">${message:no}</a>
                    	</span>
                    </span>
                </p:actionsCell>
                <p:empty>
                    <p>${message:no-results}</p>
                </p:empty>
            </t:grid>
        </t:form>
        <p:else>
            <p>${message:no-results}</p>
        </p:else>
    </t:if>

    <p:breadcrumbs>
        <a t:type="pageLink" t:page="index">${message:frontpage}</a>
        &gt; ${message:notesearch}
    </p:breadcrumbs>

    <p:leftPanel>
        <t:dashboard />
    </p:leftPanel>

    <p:rightPanel>
    
    </p:rightPanel>

</html>
