<html t:type="layout"  
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
      xmlns:p="tapestry:parameter">
      
    <p:title>${document.title}</p:title>  

    <div class="content">
        <t:zone t:id="documentZone" update="show">
            <t:delegate to="documentView"/>
        </t:zone>
        <t:block t:id="documentView">
        <t:document.view document="documentRevision"/>        
        </t:block>                
    </div>
    
    <p:breadcrumbs>
        <a t:type="pageLink" t:page="index">${message:frontpage}</a> 
        &gt; <a t:type="pageLink" t:page="documentsPage">${message:documents}</a>
        &gt; ${document.title}
    </p:breadcrumbs>     
        
    <p:leftPanel>
        <t:dashboard/>
        
        <div class="panel narrow">
            <h3>${message:pages}</h3>
            <t:document.pages document="documentRevision"/>
            <div style="clear:both;"></div>
        </div>

        
    </p:leftPanel>

    <p:rightPanel>
        <t:form t:id="createTerm" t:zone="listZone">
            <t:hidden t:id="selectedText_1" value="createTermSelection.selection"/>
            <t:hidden t:id="selectedStartId_1" value="createTermSelection.startId"/>
            <t:hidden t:id="selectedEndId_1" value="createTermSelection.endId"/>
            <a id="createTermLink" class="disabled selection-link" href="#">${message:createTerm}</a>
        </t:form>
           
        <div class="panel narrow">
            <h3>${message:notes}</h3>
                <t:zone t:id="listZone" update="show">
                    <t:delegate to="notesList"/>
                </t:zone>
            <div style="clear:both;"></div>
        </div>    
    
        <t:zone t:id="editZone" update="show"/>
        
        <t:block t:id="notesList">
            <t:if test="docNotes">
            <ul class="notes">
                <t:loop source="docNotes" value="note">
                <li> 
                    <a href="#start${note.revisionOf.localId}" class="notelink">${note.lemma}</a>
                </li>
                </t:loop>
            </ul>        
                <p:else>${message:no-notes}</p:else>
            </t:if>
        </t:block>
         
        <t:block t:id="noteEdit">
            <t:if test="!selectedNotes.empty">
            <div class="panel narrow">
                
                <t:if test="moreThanOneSelectable">
                <h3>${message:selectNote}</h3>
                <ul class="notes">
                    
                    <t:loop source="selectedNotes" value="note">
                        <li>
                            <t:eventlink t:event="edit" context="editContext" 
                                t:zone="editZone" class="notelink">${note.lemma}</t:eventlink> 
                        </li>
                    </t:loop>
                </ul>
                </t:if>
                
                <h3>${message:noteEdit}</h3>
                <div class="note_edit">
                    <b>${noteOnEdit.lemma}</b> <t:actionlink t:id="delete" t:zone="editZone" context="noteOnEdit.id">${message:delete}</t:actionlink>
                    <t:form t:id="noteEditForm" t:zone="editZone" t:context="noteOnEdit.id">
                        <t:errors/>
                        ${message:lemma-label}<br/><t:textField value="noteOnEdit.lemma"/><br/>
                        ${message:basicForm-label}<br/><t:textField value="noteOnEdit.basicForm"/><br/>
                        ${message:longText-label} <a id="longTextEditLink" href="#" style="display:none">${message:update}</a>
                        <br/><div id="longTextEdit">${noteOnEdit.longText}</div>
                        <br/>
                        
                        <t:hidden t:id="selectedText_2" value="updateLongTextSelection.selection"/>
                        <t:hidden t:id="selectedStartId_2" value="updateLongTextSelection.startId"/>
                        <t:hidden t:id="selectedEndId_2" value="updateLongTextSelection.endId"/>                                                
                        
                        <input type="submit" value="${message:save}"/>
                        
                    </t:form>
                   
                </div>
            </div>      
          </t:if>                            
        </t:block>
        
        <t:block id="emptyBlock">
            <span/>
        </t:block>
        
    </p:rightPanel>

</html>
