<html t:type="layout"  
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
      xmlns:p="tapestry:parameter">
      
    <p:title>${document.title}</p:title>  

    <div class="content">
        <t:document.view document="documentRevision"/>        
    </div>
    
    <p:breadcrumbs>
        <a t:type="pageLink" t:page="index">${message:frontpage}</a> 
        &gt; <a t:type="pageLink" t:page="documentsPage">${message:documents}</a>
        &gt; ${document.title}
    </p:breadcrumbs>     
        
    <p:leftPanel>
        <t:dashboard/>
        
        <div class="panel narrow">
            <h3>${message:revisions}</h3>
            <ul>
                <t:loop source="revisions" value="revision">
                <li>
                    <!-- TODO : with date here -->
                    <t:pagelink page="document/annotatePage" t:context="[document.id,revision]">${revision}</t:pagelink>
                </li>
                </t:loop>
            </ul>            
        </div>
                      
        <div class="panel narrow">
            <h3>${message:pages}</h3>
            <t:document.pages document="documentRevision"/>
            <div style="clear:both;"></div>
        </div>

        
    </p:leftPanel>

    <p:rightPanel>
    
        <div class="panel narrow">
            <!-- TODO : make this area updatable -->
            <h3>${message:notes}</h3>
            <ul class="notes">
                <t:loop source="docNotes" value="note">
                <li>    
                    <a href="#start${note.revisionOf.localId}" class="notelink">${note.revisionOf.localId}</a>
                </li>
                </t:loop>
            </ul>
            <div style="clear:both;"></div>
        </div>    
    
        <!-- ACTIONS :
            - update note (form submit, revision creation)
            - add new note (form submit, SVN commit)
            - delete note (note removal, SVN commit)
            - change note boundaries  (SVN commit)      
         -->                
        
        <t:zone t:id="editZone" update="show"/>
        
        <t:block t:id="noteEditForm">
            <t:loop source="notes" value="note">
                <div>
                    <b># ${note.revisionOf.localId}</b>
                    <!-- TODO : improve edit form -->
                    <t:beaneditform t:id="note" include="lemma,longText,basicForm"/>
                </div>                            
            </t:loop>      
        </t:block>
        
    </p:rightPanel>

</html>
