<html t:type="layout"  
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
      xmlns:p="tapestry:parameter">
      
    <p:title>${document.title}</p:title>  

    <div class="content">
        <t:document.view document="documentRevision"/>        
    </div>
    
    <p:breadcrumbs>
        <a t:type="pageLink" t:page="index">${message:frontpage}</a> 
        &gt; <a t:type="pageLink" t:page="documentsPage">${message:documents}</a>
        &gt; ${document.title}
    </p:breadcrumbs>     
        
    <p:leftPanel>
        <t:dashboard/>
        
        <!-- 
        <div class="panel narrow">
            <h3>${message:revisions}</h3>
            <ul>
                <t:loop source="revisions" value="revision">
                <li>
                    <t:pagelink page="document/annotatePage" t:context="[document.id,revision]">${revision}</t:pagelink>
                </li>
                </t:loop>
            </ul>            
        </div>
         -->
                      
        <div class="panel narrow">
            <h3>${message:pages}</h3>
            <t:document.pages document="documentRevision"/>
            <div style="clear:both;"></div>
        </div>

        
    </p:leftPanel>

    <p:rightPanel>
        <t:form t:id="createTerm" t:zone="listZone">
            <t:hidden t:id="selectedText" value="selectedText.selection"/>
            <t:hidden t:id="selectedStartId" value="selectedText.startId"/>
            <t:hidden t:id="selectedEndId" value="selectedText.endId"/>
            <a id="createTermLink" class="disabled" href="#" onClick="return false;">${message:createTerm}</a>
        </t:form>
           
        <div class="panel narrow">
            <h3>${message:notes}</h3>
            <t:if test="docNotes">
                <t:zone t:id="listZone" update="show">
                    <t:delegate to="notesList"/>
                </t:zone>
                <p:else>${message:no-notes}</p:else>
            </t:if>
            <div style="clear:both;"></div>
        </div>    
    
        <t:zone t:id="editZone" update="show"/>
        
        <t:block t:id="notesList">
            <ul class="notes">
                <t:loop source="docNotes" value="note">
                <li>    
                    <a href="#start${note.revisionOf.localId}" class="notelink">${note.lemma}</a>
                </li>
                </t:loop>
            </ul>        
        </t:block>
        
        <t:block t:id="noteEdit">
            <t:loop source="notes" value="note">
                <div>
                    <b>${note.lemma}</b>
                    <t:form t:id="noteEditForm" t:zone="editZone" t:context="note.id">
                        <t:errors/>
                        ${message:lemma-label}<br/><t:textField value="note.lemma"/><br/>
                        ${message:basicForm-label}<br/><t:textField value="note.basicForm"/><br/>
                        ${message:longText-label}<br/>${note.longText}<br/>                        
                        <input type="submit" value="${message:save}"/> 
                    </t:form>
                </div>                            
            </t:loop>      
        </t:block>
        
    </p:rightPanel>

</html>
